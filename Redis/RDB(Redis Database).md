# 설명
![image](https://github.com/eastperson/TIL/assets/66561524/4257e11d-e8e7-43f0-a004-cbc418e14c1d)

**RDB 사용의 장점**

- 작은 파일 사이즈로 파일 관리가 용이(원격지 백업, 버전 관리 등)
- fork를 이용해 백업하므로 서비스 중인 프로세스는 성능에 영향 없음
- 데이터 스냅샷 방식이므로 빠른 복구가 가능

**RDB 사용의 단점**

- 스냅샷을 저장하는 시점 사이의 데이터 변경사항은 유실될 수 있음
- fork를 이용하기 때문에 시간이 오래 걸릴 수 있고 CPU와 메모리 자원을 많이 소모
- 데이터 무결성이나 정합성에 대한 요구가 크지 않은 경우 사용 가능 (마지막 백업시 에러 발생 등의 문제)

Redis의 RDB(Redis DataBase) 저장은 사용자가 설정한 시간 간격과 변경된 키의 개수에 따라 스냅샷이 만들어지는 방식으로 작동합니다.

기본적으로, Redis 설정 파일(redis.conf)에서는 save 지시어를 사용하여 RDB 스냅샷 생성의 트리거를 설정합니다. 예를 들어, 기본 설정인 아래와 같은 설정을 가지고 있다면,

```
save 900 1
save 300 10
save 60 10000
```

900초(15분) 동안에 1개 이상의 키가 변경되면 스냅샷을 생성합니다.
300초(5분) 동안에 10개 이상의 키가 변경되면 스냅샷을 생성합니다.
60초 동안에 10000개 이상의 키가 변경되면 스냅샷을 생성합니다.
위의 세 가지 조건 중 하나라도 충족되면 RDB 스냅샷이 생성됩니다.

또한, 사용자는 SAVE 또는 BGSAVE 명령어를 이용하여 수동으로 스냅샷을 생성할 수도 있습니다.

SAVE는 메인 스레드에서 실행되어 데이터의 일관성을 보장하지만, 작업이 진행되는 동안 Redis 서버가 클라이언트 요청을 처리하지 못하게 됩니다.

반면, BGSAVE는 백그라운드에서 실행되는 별도의 프로세스를 생성하여 스냅샷을 만들기 때문에, 스냅샷 생성 동안에도 Redis 서버는 클라이언트 요청을 계속 처리할 수 있습니다. 다만, 이 경우 데이터의 일관성을 위해 추가적인 처리가 필요합니다.


# 코드
```
version: '3.7'
services:
  master:
    container_name: master
    image: redis
    command: redis-server --appendonly yes
    volumes:
      - ./data:/data
    ports:
      - ${DEFAULT_MASTER_PORT}:${REDIS_PORT}
```
![image](https://github.com/eastperson/TIL/assets/66561524/c540933d-3428-4f4c-82fa-587e300d7cfa)

